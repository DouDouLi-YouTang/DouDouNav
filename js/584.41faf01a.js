"use strict";(self["webpackChunkdoudou_nav"]=self["webpackChunkdoudou_nav"]||[]).push([[584],{8584:function(e,l,t){t.r(l),t.d(l,{default:function(){return L}});var a=t(3396),i=t(2268),u=t(9242),o=t(4870),n=t(6666),s=t(7178),d=t(6e3),r=t(7139),m=t(2049);const c=e=>((0,a.dD)("data-v-1f80ddd5"),e=e(),(0,a.Cn)(),e),p={key:0,class:"website-left"},w=["onClick"],v={key:0,class:"website-left-box-edit"},f={class:"el-dropdown-link"},g={class:"website-left-add"},y=c((()=>(0,a._)("div",{style:{height:"40px"}},null,-1))),_={class:"website-right-box"},k=["id"],b={class:"website-right-title-box"},W={class:"box"},h={key:0,class:"jianjie"},U=["href"],D={class:"webUrl"},C=["src"],j={key:1,class:"bianji"},x={class:"el-dropdown-link"},V={class:"webBox"},H=c((()=>(0,a._)("div",{class:"jianjie"},"点击新增",-1))),q=["onClick"],B={class:"webBox"},I={key:0,class:"jianjie"},T={class:"webUrl"},z=["src"],E={class:"dialog-footer"};var F={__name:"WebsiteView",setup(e){const l=(0,r.oR)();l.dispatch("createData");const t=(0,a.Fl)((()=>l.state.webArry));(0,a.m0)((()=>{1==t.value.length&&0==t.value[0].childers.length&&(0,n.bM)({title:"提示",message:'<span style="color:#F56C6C;">检测到当前分类子项为空，如需添加请点击右下方编辑按钮新增</span>',dangerouslyUseHTMLString:!0,duration:0})}));const c=(0,a.Fl)((()=>l.getters.getmessage)),F=(0,o.iH)(null),M=(0,o.iH)(!1),S=(0,o.iH)(""),L=(0,o.iH)(!1),R=(0,o.iH)(!1),$=(0,o.iH)(!1),Y=(0,o.iH)(window.innerWidth),K=(0,o.iH)(!1),N=(0,o.iH)(!1);(0,a.m0)((()=>{Y.value<500?$.value=!1:$.value=!0})),window.addEventListener("resize",(()=>{Y.value=window.innerWidth}));const O=(0,o.qj)({});(0,a.m0)((()=>{O.selectData=t.value.map((e=>({title:e.title,value:e.key})))}));const P=(0,o.iH)(null),Z=(e,l,t)=>{const a=/^((https|http|ftp|rtsp|mms)?:\/\/)[^\s]+/;""===l||a.test(l)?t():t(new Error("请输入正确的网址"))},A=(0,o.qj)({title:{required:!0,message:"请输入网站名称",trigger:"blur"},url:[{required:!0,message:"请输入网页地址",trigger:"blur"},{validator:Z,trigger:"blur"}],imgUrl:[{validator:Z,trigger:"blur"}]}),G=function(e,l,t){M.value=!0,S.value="edit",O.metaDataId=l.metaDataId,O.sort=e.key,O.title=l.webName,O.url=l.url,O.jianjie=l.jianjie,O.imgUrl=l.imgUrl},J=function(e){M.value=!0,S.value="add",O.sort=e.key,O.metaDataId=(new Date).getTime(),O.imgUrl=""};function Q(){Object.keys(O).forEach((e=>{"selectData"!=e&&delete O[e]}));const e=document.getElementById("dailogImg");e.onload=null,e.onerror=null}const X=function(){P.value.validate((e=>{e?("edit"==S.value?l.commit("editData",O):l.commit("addData",O),(0,s.z8)({message:c.value.message,type:c.value.type}),"success"==c.value.type&&(M.value=!1,te())):console.log("验证失败")}))},ee=function(e,t,a){d.T.confirm(`你确定要删除 <span style="color:#ec4141">${e.title}</span> 分类下的 <span style="color:#ec4141">${t.webName}</span> 吗?`,"警告",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,confirmButtonClass:"deleteButton"}).then((()=>{const a={key:e.key,metaDataId:t.metaDataId};l.commit("delData",a),(0,s.z8)({message:c.value.message,type:c.value.type}),"success"==c.value.type&&te()})).catch((()=>{}))};function le(){const e=/^((https|http|ftp|rtsp|mms)?:\/\/)[^\s]+/;if(e.test(O.url)){const e=new URL(O.url);O.imgUrl!=e.origin+"/favicon.ico"&&0==L.value&&(L.value=!0),O.imgUrl=e.origin+"/favicon.ico";const l=document.getElementById("dailogImg");l.onload=function(){""!=O.imgUrl&&(0,n.bM)({title:"成功",message:"图标获取成功!",type:"success"}),L.value=!1},l.onerror=function(){(0,n.bM)({title:"错误",message:"图标获取失败!",type:"error"}),O.imgUrl="",L.value=!1}}else(0,s.z8)({message:"请输入正确的网址",type:"error"})}async function te(){const e="DouDouDB",l="website",a=await m.ZP.openDB(e,l,1),i={id:1,data:JSON.stringify(t.value)};m.ZP.updateDB(a,l,i)}const ae=(0,o.qj)({}),ie=(0,o.iH)(null),ue=(0,o.qj)({title:{required:!0,message:"请输入标题名称",trigger:"blur"}});function oe(e,l){ae.type=e,"add"==ae.type?ae.key=(new Date).getTime():(ae.key=l.key,ae.title=l.title),N.value=!0}function ne(e){d.T.confirm(`你确定要删除 <span style="color:#ec4141">${e.title}</span> 这个分类吗?  </br>\n    警告：该操作会删除 <span style="color:#ec4141">${e.title}</span> 分类下的所有内容！\n    `,"警告",{type:"warning",confirmButtonText:"删除",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,confirmButtonClass:"deleteButton"}).then((()=>{const t=e.key;l.commit("sortDel",t),(0,s.z8)({message:c.value.message,type:c.value.type}),"success"==c.value.type&&te()})).catch((()=>{}))}function se(){ie.value.validate((e=>{e&&("edit"==ae.type?l.commit("editSort",ae):l.commit("addSort",ae),(0,s.z8)({message:c.value.message,type:c.value.type}),"success"==c.value.type&&(N.value=!1,te()))}))}function de(){Object.keys(ae).forEach((e=>delete ae[e]))}const re=(0,o.iH)(null),me=(0,o.iH)("freeMovies"),ce=(0,o.iH)(!1),pe=e=>{ce.value=!0,me.value=e;let l=document.querySelector(`#${e}`);re.value.scrollTo({top:l.offsetTop-40,behavior:"smooth"})},we=(0,o.qj)([]);let ve=new IntersectionObserver((e=>{let l=e[0].target.id,a=e[0].isIntersecting;if(a){let e=we.findIndex((e=>e==l));-1==e&&we.push(l)}else{let e=we.findIndex((e=>e==l));-1!==e&&we.splice(e,1)}if(ce.value)return;let i="";for(const u of t.value)if(-1!==we.findIndex((e=>e===u.key))){i=u.key;break}me.value=i}),{threshold:[0,.25,.5,1]});const fe=()=>{for(const e of t.value){let l=document.querySelector(`#${e.key}`);we.push(e.key),ve.observe(l)}};return(0,a.bv)((()=>{let e=document.querySelector(".website-right-box");e.addEventListener("mousewheel",(()=>{ce.value=!1})),setTimeout((()=>{fe()}),500)})),(e,l)=>{const o=(0,a.up)("More"),n=(0,a.up)("el-icon"),s=(0,a.up)("Edit"),d=(0,a.up)("el-dropdown-item"),r=(0,a.up)("Delete"),m=(0,a.up)("el-dropdown-menu"),c=(0,a.up)("el-dropdown"),Y=(0,a.up)("Plus"),Z=(0,a.up)("el-scrollbar"),te=(0,a.up)("el-aside"),ce=(0,a.up)("el-main"),we=(0,a.up)("el-container"),ve=(0,a.up)("el-tooltip"),fe=(0,a.up)("el-divider"),ge=(0,a.up)("el-option"),ye=(0,a.up)("el-select"),_e=(0,a.up)("el-form-item"),ke=(0,a.up)("el-input"),be=(0,a.up)("el-button"),We=(0,a.up)("el-form"),he=(0,a.up)("el-dialog"),Ue=(0,a.up)("Expand"),De=(0,a.up)("el-table-column"),Ce=(0,a.up)("el-table");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(we,{class:"common-layout",ref_key:"divDom",ref:F},{default:(0,a.w5)((()=>[(0,a.Wm)(te,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[t.value.length?((0,a.wg)(),(0,a.iD)("div",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.value,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:"website-left-box",key:l},[(0,a._)("div",{class:(0,i.C_)({active:e.key==me.value}),onClick:l=>pe(e.key),style:(0,i.j5)({paddingRight:R.value?"20px":"0"})},[(0,a.Uk)((0,i.zw)(e.title)+" ",1),R.value?((0,a.wg)(),(0,a.iD)("div",v,[(0,a.Wm)(c,{trigger:"click"},{dropdown:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{onClick:l=>oe("edit",e)},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s)])),_:1}),(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(d,{style:{color:"#F56C6C"},onClick:l=>ne(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r)])),_:1}),(0,a.Uk)("删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a._)("span",f,[(0,a.Wm)(n,{class:"on-inline"},{default:(0,a.w5)((()=>[(0,a.Wm)(o)])),_:1})])])),_:2},1024)])):(0,a.kq)("",!0)],14,w)])))),128)),(0,a.Wm)(u.uT,{name:"bounce"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",{class:"website-left-box",onClick:l[0]||(l[0]=e=>oe("add"))},[(0,a._)("p",g,[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Y)])),_:1})])],512),[[u.F8,R.value]])])),_:1})])):(0,a.kq)("",!0)])),_:1})])),_:1}),(0,a.Wm)(ce,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{ref_key:"scrollbarRef",ref:re},{default:(0,a.w5)((()=>[y,(0,a._)("div",_,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.value,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:"website-right-title",key:l,id:e.key},[(0,a._)("div",b,[(0,a._)("h2",null,(0,i.zw)(e.title),1)]),(0,a._)("div",W,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.childers,((l,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"webBox",key:t},[l.jianjie?((0,a.wg)(),(0,a.iD)("div",h,(0,i.zw)(l.jianjie),1)):(0,a.kq)("",!0),(0,a._)("a",{href:l.url,target:"_blank"},[(0,a._)("div",D,[(0,a._)("img",{src:l.imgUrl?l.imgUrl:"https://img.bidianer.com/image/icon/empty.svg"},null,8,C),(0,a._)("div",null,(0,i.zw)(l.webName),1)])],8,U),$.value?((0,a.wg)(),(0,a.iD)("div",j,[(0,a.Wm)(c,{trigger:"click"},{dropdown:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{onClick:a=>G(e,l,t)},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s)])),_:1}),(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(d,{style:{color:"#F56C6C"},onClick:a=>ee(e,l,t)},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r)])),_:1}),(0,a.Uk)("删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a._)("span",x,[(0,a.Wm)(n,{class:"on-inline"},{default:(0,a.w5)((()=>[(0,a.Wm)(o)])),_:1})])])),_:2},1024)])):(0,a.kq)("",!0)])))),128)),(0,a.Wm)(u.uT,{name:"bounce"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",V,[H,(0,a._)("p",{onClick:l=>J(e)},[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Y)])),_:1})],8,q)],512),[[u.F8,R.value]])])),_:2},1024)])],8,k)))),128))])])),_:1},512)])),_:1})])),_:1},512),$.value?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"editMode",onClick:l[1]||(l[1]=e=>R.value=!R.value)},[(0,a.Wm)(ve,{class:"box-item",effect:"dark",content:"编辑模式",placement:"top"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s)])),_:1})])),_:1})])):(0,a.kq)("",!0),(0,a.Wm)(he,{modelValue:M.value,"onUpdate:modelValue":l[8]||(l[8]=e=>M.value=e),title:"edit"==S.value?"修改":"新增",width:"500",class:"tanceng",style:{"border-radius":"5px"},onClose:Q},{footer:(0,a.w5)((()=>[(0,a._)("span",E,[(0,a.Wm)(be,{onClick:l[7]||(l[7]=e=>M.value=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1}),(0,a.Wm)(be,{type:"primary",onClick:X,disabled:L.value},{default:(0,a.w5)((()=>[(0,a.Uk)(" 确定 ")])),_:1},8,["disabled"])])])),default:(0,a.w5)((()=>[(0,a._)("div",(0,a.dG)({class:"box"},O),[(0,a._)("div",B,[O.jianjie?((0,a.wg)(),(0,a.iD)("div",I,(0,i.zw)(O.jianjie),1)):(0,a.kq)("",!0),(0,a._)("a",null,[(0,a._)("div",T,[(0,a._)("img",{id:"dailogImg",src:O.imgUrl?O.imgUrl:"https://img.bidianer.com/image/icon/empty.svg"},null,8,z),(0,a._)("div",null,(0,i.zw)(O.title),1)])])])],16),(0,a.Wm)(fe,{style:{"margin-top":"10px"}}),(0,a.Wm)(We,{"label-width":"100px",rules:A,ref_key:"ruleFormRef",ref:P,model:O,style:{"max-width":"460px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(_e,{label:"分类"},{default:(0,a.w5)((()=>[(0,a.Wm)(ye,{disabled:"edit"==S.value,modelValue:O.sort,"onUpdate:modelValue":l[2]||(l[2]=e=>O.sort=e),placeholder:"请选择一个分类"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(O.selectData,((e,l)=>((0,a.wg)(),(0,a.j4)(ge,{key:l,label:e.title,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1}),(0,a.Wm)(_e,{label:"网站名称",prop:"title"},{default:(0,a.w5)((()=>[(0,a.Wm)(ke,{modelValue:O.title,"onUpdate:modelValue":l[3]||(l[3]=e=>O.title=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(_e,{label:"简介"},{default:(0,a.w5)((()=>[(0,a.Wm)(ke,{modelValue:O.jianjie,"onUpdate:modelValue":l[4]||(l[4]=e=>O.jianjie=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(_e,{label:"网页地址",prop:"url"},{default:(0,a.w5)((()=>[(0,a.Wm)(ke,{modelValue:O.url,"onUpdate:modelValue":l[5]||(l[5]=e=>O.url=e)},{append:(0,a.w5)((()=>[(0,a.Wm)(be,{type:"primary",onClick:le},{default:(0,a.w5)((()=>[(0,a.Uk)("获取网页图标")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(_e,{label:"网页图标地址",prop:"imgUrl"},{default:(0,a.w5)((()=>[(0,a.Wm)(ke,{clearable:"",modelValue:O.imgUrl,"onUpdate:modelValue":l[6]||(l[6]=e=>O.imgUrl=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"]),(0,a.Wm)(he,{modelValue:K.value,"onUpdate:modelValue":l[9]||(l[9]=e=>K.value=e),title:"排序"},{default:(0,a.w5)((()=>[(0,a.Wm)(Ce,{id:"table",data:e.list,"row-key":"id",style:{width:"500px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(De,{label:"排序",width:"60",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(n,{class:"handle",style:{cursor:"move"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Ue)])),_:1})])),_:1}),(0,a.Wm)(De,{prop:"name",label:"昵称",width:"180"})])),_:1},8,["data"])])),_:1},8,["modelValue"]),(0,a.Wm)(he,{class:"sortDialog",modelValue:N.value,"onUpdate:modelValue":l[12]||(l[12]=e=>N.value=e),title:"edit"==ae.type?"修改分类名称":"新增分类",width:"500",onClose:de},{footer:(0,a.w5)((()=>[(0,a._)("span",null,[(0,a.Wm)(be,{onClick:l[11]||(l[11]=e=>N.value=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1}),(0,a.Wm)(be,{type:"primary",onClick:se},{default:(0,a.w5)((()=>[(0,a.Uk)(" 确定 ")])),_:1})])])),default:(0,a.w5)((()=>[(0,a.Wm)(We,{model:ae,ref_key:"sortFormRule",ref:ie,rules:ue,"label-width":"120px"},{default:(0,a.w5)((()=>[(0,a.Wm)(_e,{label:"分类名称",prop:"title"},{default:(0,a.w5)((()=>[(0,a.Wm)(ke,{clearable:"",modelValue:ae.title,"onUpdate:modelValue":l[10]||(l[10]=e=>ae.title=e),placeholder:"请输入分类名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])],64)}}},M=t(89);const S=(0,M.Z)(F,[["__scopeId","data-v-1f80ddd5"]]);var L=S}}]);
//# sourceMappingURL=584.41faf01a.js.map